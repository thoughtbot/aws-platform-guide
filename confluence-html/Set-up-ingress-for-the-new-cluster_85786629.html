<!DOCTYPE html>
<html>
    <head>
        <title>AWS Platform Guide : Set up ingress for the new cluster</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">AWS Platform Guide</a></span>
                            </li>
                                                    <li>
                                <span><a href="AWS-Platform-Guide-Home_13697366.html">AWS Platform Guide Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Maintain_213549057.html">Maintain</a></span>
                            </li>
                                                    <li>
                                <span><a href="Upgrade-Flightdeck_85688321.html">Upgrade Flightdeck</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            AWS Platform Guide : Set up ingress for the new cluster
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Joe Ferris</span> on Jan 06, 2023
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <div class="panel" style="background-color: #FFFAE6;border-width: 1px;"><div class="panelContent" style="background-color: #FFFAE6;">
<p>This is an advanced topic for platform engineers.</p>
</div></div><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="attachments/85786629/85557261.png" data-image-src="attachments/85786629/85557261.png" data-height="1222" data-width="1662" data-unresolved-comment-count="0" data-linked-resource-id="85557261" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="aws-ingress-migration.png" data-base-url="https://thoughtbot.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="85786629" data-linked-resource-container-version="1" data-media-id="302c1464-1a4c-4c26-9b2a-e5c997b6c6bb" data-media-type="file"></span><p>Edit the ingress stack for your sandbox clusters.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">infra/
  ingress/
    sandbox/</pre>
</div></div><p>Add your new cluster to the list of clusters and target groups.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">module &quot;ingress&quot; {
  cluster_names = [&quot;mycompany-sandbox-v1&quot;, &quot;mycompany-sandbox-v2&quot;]

  target_group_weights = {
    mycompany-sandbox-v1 = 100
    mycompany-sandbox-v2 = 0
  }
}</pre>
</div></div><p>Apply this module to create the new target group. Using the above weights, the target group will be created but will receive no traffic. We will wait until workloads are fully deployed to shift traffic.</p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/85786629/85819404.png">ingress.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/85786629/85557261.png">aws-ingress-migration.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Mar 18, 2024 10:53</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
